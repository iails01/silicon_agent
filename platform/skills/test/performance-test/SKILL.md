---
name: performance-test
display_name: "性能测试"
description: 设计性能基准测试，评估响应时间、吞吐量和资源消耗
layer: L3
metadata:
  emoji: "⚡"
  tags: ["test", "performance", "benchmark"]
  applicable_roles: ["test"]
---

# 性能基准测试

设计性能测试方案，评估系统的响应时间、吞吐量、资源消耗和性能瓶颈。

## 输入

用户会提供：
- `target`：性能测试目标（API 端点、函数、模块）
- `requirements`（可选）：性能指标要求（响应时间 < 200ms、QPS > 1000 等）
- `baseline`（可选）：现有性能基线数据

## 工作流

### Step 1：性能目标定义

明确测试指标：
- 响应时间（P50 / P95 / P99）
- 吞吐量（QPS / TPS）
- 资源消耗（CPU、内存、连接数）
- 并发承载能力
- 错误率阈值

### Step 2：测试场景设计

设计不同负载场景：
- **基准测试**：单请求性能（冷启动、热缓存）
- **负载测试**：正常并发下的表现
- **压力测试**：超过预期并发的表现
- **耐久测试**：长时间运行的稳定性

### Step 3：测试代码生成

生成性能测试代码：
- 使用项目适配的测试框架（pytest-benchmark / locust / k6）
- 参数化不同数据量级
- 测量关键指标
- 记录资源使用

### Step 4：瓶颈分析策略

设计瓶颈定位方案：
- N+1 查询检测
- 慢查询识别
- 内存泄漏检测
- 连接池饱和度

## 输出格式

```markdown
## 性能测试报告

### 测试目标
{描述}

### 性能指标

| 指标 | 目标值 | 实测值 | 状态 |
|------|--------|--------|------|
| P50 响应时间 | < {n}ms | {n}ms | ✅/❌ |
| P95 响应时间 | < {n}ms | {n}ms | ✅/❌ |
| QPS | > {n} | {n} | ✅/❌ |
| 错误率 | < {n}% | {n}% | ✅/❌ |

### 测试场景结果
{各场景详细结果}

### 瓶颈发现
| # | 类型 | 位置 | 影响 | 建议 |
|---|------|------|------|------|
| 1 | {类型} | `{location}` | {描述} | {优化建议} |

### 优化建议
1. {建议}
2. {建议}
```
