---
name: risk-assessment
display_name: "风险评估"
description: 评估任务执行前的技术风险和影响范围，制定缓解策略
layer: L2
metadata:
  emoji: "⚠️"
  tags: ["orchestrator", "risk", "assessment"]
  applicable_roles: ["orchestrator"]
---

# 风险评估与缓解

在任务执行前评估技术风险、影响范围和潜在失败点，制定缓解策略和回滚方案。

## 输入

用户会提供：
- `task_description`：任务描述
- `affected_files`（可选）：受影响的文件列表
- `project_context`（可选）：项目背景

## 工作流

### Step 1：影响范围分析

使用 `search-codebase` skill 评估：
- 受影响的文件数量和模块
- 下游依赖链（谁依赖这些代码）
- 公共 API 变更（是否 breaking change）
- 数据库 schema 变更

### Step 2：风险维度评估

从以下维度评估风险（1-5 分）：

| 维度 | 说明 |
|------|------|
| 复杂度 | 涉及多少模块、跨层级程度 |
| 稳定性 | 修改的代码是否是热点/核心路径 |
| 可逆性 | 是否容易回滚、是否涉及数据迁移 |
| 安全性 | 是否涉及认证/支付/敏感数据 |
| 兼容性 | 是否影响现有 API 契约或数据格式 |

### Step 3：缓解策略

为每个高风险项制定：
- 预防措施（code review、gate 审批）
- 监控方案（日志、告警指标）
- 回滚计划（如何快速恢复）

### Step 4：建议 Gate 配置

基于风险等级建议人工审批节点：
- 低风险（总分 < 10）：无 Gate
- 中风险（10-15）：spec_review Gate
- 高风险（> 15）：spec_review + code_review Gate

## 输出格式

```markdown
## 风险评估报告

### 任务概要
{描述}

### 影响范围
- 受影响文件：{n} 个
- 受影响模块：{模块列表}
- Breaking Change：{是/否}

### 风险矩阵

| 维度 | 评分 | 说明 |
|------|------|------|
| 复杂度 | {1-5} | {原因} |
| 稳定性 | {1-5} | {原因} |
| 可逆性 | {1-5} | {原因} |
| 安全性 | {1-5} | {原因} |
| 兼容性 | {1-5} | {原因} |
| **总分** | **{sum}** | **{等级}** |

### 缓解策略
1. {策略描述}
2. {策略描述}

### 建议 Gate 配置
- {gate_type}：{原因}

### 回滚方案
{回滚步骤}
```
