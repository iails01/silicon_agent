---
name: design-architecture
display_name: "架构设计"
description: 设计系统架构方案，包括组件划分、技术选型和交互流程
layer: L1
metadata:
  emoji: "🏗️"
  tags: ["spec", "architecture", "design"]
  applicable_roles: ["spec"]
---

# 系统架构设计

设计系统架构方案，包括组件划分、技术选型、层级关系和交互流程。

## 输入

用户会提供：
- `requirement`：功能需求描述
- `tech_stack`（可选）：现有技术栈约束
- `scale`（可选）：规模需求（用户量、并发量等）

## 工作流

### Step 1：现有架构分析

使用 `search-codebase` skill 了解项目现状：
- 目录结构和分层模式
- 现有组件和模块边界
- 技术栈和框架版本
- 已有的设计模式和约定

### Step 2：组件划分

基于需求设计组件：
- 按职责划分模块（高内聚、低耦合）
- 确定模块间的通信方式（同步/异步/事件驱动）
- 设计接口契约（每个模块的输入/输出）
- 考虑横切关注点（日志、认证、错误处理）

### Step 3：技术选型

为每个组件选择合适的实现方案：
- 遵循项目已有的技术栈
- 选择成熟稳定的方案优于新潮方案
- 考虑团队熟悉度和维护成本
- 评估性能和扩展性需求

### Step 4：交互流程设计

描述关键业务流程的数据流向：
- 请求处理流程
- 数据读写路径
- 错误处理和降级策略
- 异步任务处理流程

### Step 5：非功能性设计

考虑非功能性需求：
- 性能：缓存策略、查询优化
- 可靠性：重试、熔断、降级
- 安全：认证、授权、数据加密
- 可观测性：日志、指标、链路追踪

## 输出格式

```markdown
## 架构设计文档

### 设计概要
{一段话描述整体架构方案}

### 组件图

| 组件 | 职责 | 技术选型 | 依赖 |
|------|------|----------|------|
| {名称} | {职责} | {技术} | {依赖组件} |

### 分层结构
- API 层：{描述}
- Service 层：{描述}
- Data 层：{描述}

### 关键流程

#### {流程名称}
1. {步骤1}
2. {步骤2}
3. {步骤3}

### 非功能性设计
- 性能：{方案}
- 可靠性：{方案}
- 安全：{方案}

### 文件结构
```
{目录树}
```

### 实施建议
- {建议1}
- {建议2}
```
