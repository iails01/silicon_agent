---
name: security-scan
display_name: "安全扫描"
description: 基于 OWASP Top 10 对代码进行安全扫描，识别潜在漏洞
layer: L2
metadata:
  emoji: "🛡️"
  tags: ["review", "security", "owasp"]
  applicable_roles: ["review"]
---

# OWASP 安全扫描

基于 OWASP Top 10 对代码进行安全审查，识别潜在的安全漏洞并提供修复建议。

## 输入

用户会提供：
- `code`：要审查的代码文件或目录
- `tech_stack`（可选）：技术栈信息

## 工作流

### Step 1：收集代码

使用 `search-codebase` skill 和 `read` 工具获取需要审查的代码文件。

### Step 2：OWASP Top 10 逐项检查

按以下清单逐项审查：

1. **A01 - 访问控制失效**：检查认证/授权逻辑、路由保护、权限校验
2. **A02 - 加密失败**：检查敏感数据处理、密码存储、传输加密
3. **A03 - 注入攻击**：检查 SQL 注入、命令注入、XSS、模板注入
4. **A04 - 不安全设计**：检查业务逻辑漏洞、缺失的安全控制
5. **A05 - 安全配置错误**：检查默认配置、调试模式、错误信息泄露
6. **A06 - 易受攻击的组件**：检查依赖版本、已知漏洞
7. **A07 - 认证失败**：检查认证流程、会话管理、密码策略
8. **A08 - 数据完整性失败**：检查反序列化、CI/CD 安全
9. **A09 - 日志和监控不足**：检查审计日志、异常监控
10. **A10 - SSRF**：检查服务端请求伪造风险

### Step 3：严重性评估

对每个发现的问题评估：
- 严重性：Critical / High / Medium / Low / Info
- 可利用性：容易 / 中等 / 困难
- 影响范围：数据泄露 / 权限提升 / 服务中断 等

## 输出格式

```markdown
## 安全扫描报告

### 扫描范围
{文件列表}

### 发现总览
| 严重性 | 数量 |
|--------|------|
| Critical | {n} |
| High | {n} |
| Medium | {n} |
| Low | {n} |

### 详细发现

#### [{severity}] {漏洞标题}
- **OWASP 分类**：{A0x - 名称}
- **位置**：`{file}:{line}`
- **描述**：{漏洞描述}
- **风险**：{可能的攻击方式和影响}
- **修复建议**：
  ```{lang}
  {修复代码示例}
  ```

### 安全评分
{总体安全评分和建议}
```
