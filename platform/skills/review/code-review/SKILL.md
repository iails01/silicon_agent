---
name: code-review
display_name: "代码审查"
description: 代码质量审查，检查可读性、可维护性、性能和最佳实践
layer: L2
metadata:
  emoji: "📝"
  tags: ["review", "code-quality", "best-practices"]
  applicable_roles: ["review"]
---

# 代码质量审查

对代码进行全面的质量审查，评估可读性、可维护性、性能和最佳实践遵循情况。

## 输入

用户会提供：
- `code`：要审查的代码文件或目录
- `focus`（可选）：重点关注的方面（性能 / 可读性 / 架构等）

## 工作流

### Step 1：收集代码

使用 `search-codebase` skill 和 `read` 工具获取需要审查的代码文件。

### Step 2：结构审查

检查代码的整体结构：
- 文件组织是否合理
- 模块划分是否清晰
- 依赖关系是否合理（避免循环依赖）
- 分层是否正确（不跨层调用）

### Step 3：代码质量审查

逐文件检查：
- **命名**：变量/函数/类命名是否清晰且一致
- **函数设计**：函数是否职责单一、参数数量是否合理
- **错误处理**：异常处理是否恰当、错误信息是否有用
- **类型安全**：类型注解是否完整、是否有类型不安全的操作
- **重复代码**：是否有可提取的公共逻辑
- **复杂度**：是否有过于复杂的函数（嵌套层级 > 3）

### Step 4：性能审查

检查潜在的性能问题：
- N+1 查询
- 不必要的循环或重复计算
- 大数据集的内存使用
- 缺失的索引或缓存

### Step 5：一致性检查

与项目现有代码对比：
- 编码风格是否一致
- API 设计模式是否一致
- 错误处理模式是否一致

## 输出格式

```markdown
## 代码审查报告

### 审查范围
{文件列表}

### 总体评价
**评分**：{score}/10
**一句话总结**：{总结}

### 发现列表

| # | 类型 | 严重性 | 文件 | 说明 |
|---|------|--------|------|------|
| 1 | {bug/style/perf/design} | {high/medium/low} | {file}:{line} | {说明} |

### 详细说明

#### [{type}] {标题}
- **位置**：`{file}:{line}`
- **问题**：{描述}
- **建议**：{修改建议}

### 优点
- {值得肯定的实现}

### 改进建议
1. {建议1}
2. {建议2}
```
