---
name: debug-code
display_name: "问题调试"
description: 分析错误信息和代码逻辑，定位并修复 bug
layer: L2
metadata:
  emoji: "🐛"
  tags: ["coding", "debug", "fix"]
  applicable_roles: ["coding"]
---

# 调试与错误修复

分析错误信息、日志和代码逻辑，定位 bug 根因并提供修复方案。

## 输入

用户会提供：
- `error`：错误信息、堆栈跟踪或异常行为描述
- `context`（可选）：相关代码文件或日志
- `steps_to_reproduce`（可选）：复现步骤

## 工作流

### Step 1：错误分析

解读错误信息：
- 错误类型和消息
- 堆栈跟踪中的关键帧
- 触发条件

### Step 2：代码定位

使用 `search-codebase` skill 和 `read` 工具定位相关代码：
- 找到堆栈跟踪中涉及的文件
- 阅读错误发生点附近的代码
- 追踪数据流和调用链

### Step 3：根因分析

分析可能的原因：
- 空值/类型错误
- 逻辑错误（条件判断、循环边界等）
- 并发/时序问题
- 配置/环境问题
- 依赖版本不兼容

### Step 4：修复实施

使用 `write` 工具修改代码：
- 最小化修改范围
- 确保修复不引入新问题
- 添加防御性代码（如有必要）

### Step 5：验证

如果可能，使用 `execute` 工具运行相关代码验证修复效果。

## 输出格式

```markdown
## 调试报告

### 错误摘要
{一句话描述错误}

### 根因分析
**原因**：{根本原因}
**位置**：`{file}:{line}`
**影响范围**：{影响描述}

### 修复方案
{修复了什么，怎么修复的}

### 修改文件
| 文件 | 修改说明 |
|------|---------|
| {path} | {说明} |

### 验证结果
{运行结果或验证方式建议}
```
